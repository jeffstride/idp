
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Curve of Best Fit &#8212; IDP at NCHS</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.1/css/all.min.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.1/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.1/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.1/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=384b581d" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.1e8bd061cd6da7fc9cf755528e8ffc24.min.css?v=0a3b3ea7" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css?v=6c3db60c" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae" />
  <script src="../_static/vendor/fontawesome/6.5.1/js/all.min.js?digest=8d27b9dea8ad943066ae"></script>

    <script src="../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../_static/doctools.js?v=888ff710"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=efea14e4"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
    <script kind="utterances">

    var commentsRunWhenDOMLoaded = cb => {
    if (document.readyState != 'loading') {
        cb()
    } else if (document.addEventListener) {
        document.addEventListener('DOMContentLoaded', cb)
    } else {
        document.attachEvent('onreadystatechange', function() {
        if (document.readyState == 'complete') cb()
        })
    }
}

var addUtterances = () => {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src = "https://utteranc.es/client.js";
    script.async = "async";

    script.setAttribute("repo", "jeffstride/idp");
    script.setAttribute("issue-term", "pathname");
    script.setAttribute("theme", "preferred-color-scheme");
    script.setAttribute("label", "💬 Comments");
    script.setAttribute("crossorigin", "anonymous");

    sections = document.querySelectorAll("div.section");
    if (sections !== null) {
        section = sections[sections.length-1];
        section.appendChild(script);
    }
}
commentsRunWhenDOMLoaded(addUtterances);
</script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js?v=36754332"></script>
    <script async="async" src="https://www.googletagmanager.com/gtag/js?id=G-DW6SHVPBYV"></script>
    <script>
                window.dataLayer = window.dataLayer || [];
                function gtag(){ dataLayer.push(arguments); }
                gtag('js', new Date());
                gtag('config', 'G-DW6SHVPBYV');
            </script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>
                window.dataLayer = window.dataLayer || [];
                function gtag(){ dataLayer.push(arguments); }
                gtag('js', new Date());
                gtag('config', 'G-DW6SHVPBYV');
            </script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'visualizations/line_of_best_fit';</script>
    <link rel="icon" href="../_static/favicon.png"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Case Study on Distance" href="case_study_dist.html" />
    <link rel="prev" title="Line Plots" href="lineplots.html" />
    
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>

    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-DW6SHVPBYV"></script>
    <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-DW6SHVPBYV');
    </script>


  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a id="pst-skip-link" class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <header class="bd-header navbar navbar-expand-lg bd-navbar">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/logo.png" class="logo__image only-light" alt="IDP at NCHS - Home"/>
    <script>document.write(`<img src="../_static/logo.png" class="logo__image only-dark" alt="IDP at NCHS - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../index.html">
                    <i class="fas fa-hand-sparkles fa-fw"></i> Introduction
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../homework-assignments/index.html"><i class="fas fa-book fa-fw"></i> Homework Assignments</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../homework-assignments/hw1.html"><i class="fas fa-laptop fa-fw"></i> HW1 - Startup</a></li>
<li class="toctree-l2"><a class="reference internal" href="../homework-assignments/hw2.html"><i class="fas fa-laptop fa-fw"></i> HW2 - Primer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../homework-assignments/hw3.html"><i class="fas fa-laptop fa-fw"></i> HW3 - Pokémon</a></li>
<li class="toctree-l2"><a class="reference internal" href="../homework-assignments/hw4.html"><i class="fas fa-laptop fa-fw"></i> HW4 - Education</a></li>
<li class="toctree-l2"><a class="reference internal" href="../homework-assignments/hw5.html"><i class="fas fa-laptop fa-fw"></i> HW5 - Search Engine</a></li>
<li class="toctree-l2"><a class="reference internal" href="../homework-assignments/hw6.html"><i class="fas fa-laptop fa-fw"></i> HW6 - Spell Checker</a></li>


<li class="toctree-l2"><a class="reference internal" href="../homework-assignments/hw7.html"><i class="fas fa-laptop fa-fw"></i> HW7 - Mapping</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../Topics/index.html"><i class="fas fa-layer-group fa-fw"></i> Topics</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-2"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Topics/misc/index.html"><i class="fas fa-book fa-fw"></i> Miscellaneous</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-3"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../Topics/misc/submitting.html">Submitting</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Topics/misc/collections.html">Collections</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Topics/misc/comments.html">Writing Effective Comments</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Topics/misc/rand_response.html">Reversing Randomized Response</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Topics/misc/my_st.html">Notes on MyST</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Topics/Replit/index.html"><i class="fas fa-book fa-fw"></i> Replit</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-4"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../Topics/Replit/building-in-replit.html">Building in Replit</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Topics/Replit/replit-tips.html">Replit Tips</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Topics/Replit/corrupt-project.html">Corrupt Replit Project</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Topics/Replit/flake8.html">Flake8</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Topics/pandas/index.html"><i class="fas fa-book fa-fw"></i> Pandas</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-5"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../Topics/pandas/dataframe.html">DataFrame</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Topics/pandas/slicing-methods.html">DataFrame Slicing Methods</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Topics/pandas/mynb.html">Useful API</a></li>






</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Topics/machine_learning/index.html"><i class="fas fa-book fa-fw"></i> Machine Learning</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-6"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../Topics/machine_learning/feature-importance.html">Feature Importance</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Topics/machine_learning/assessing-accuracy.html">Assessing Accuracy</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Topics/machine_learning/classification.html">Classification</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Topics/machine_learning/regression.html">Regression - Distance Study</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Topics/machine_learning/classifier-rand.html">Classification - Fully Random</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Topics/machine_learning/when-to-avoid-ml.html">When to Avoid Using Machine Learning</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Topics/built-in/index.html"><i class="fas fa-book fa-fw"></i> Built-in</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-7"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../Topics/built-in/arguments.html">Arguments</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Topics/built-in/formatted-string.html">Formatted Strings</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../final-project/index.html"><i class="fas fa-layer-group fa-fw"></i> Final Project</a><input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-8"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../final-project/handouts/index.html"><i class="fas fa-layer-group fa-fw"></i> Final Project Deliverables</a><input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-9"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../final-project/handouts/discovery.html"><i class="fas fa-book fa-fw"></i> Discovery Document</a></li>
<li class="toctree-l3"><a class="reference internal" href="../final-project/handouts/organize.html"><i class="fas fa-book fa-fw"></i> Data Organization</a></li>
<li class="toctree-l3"><a class="reference internal" href="../final-project/handouts/final.html"><i class="fas fa-book fa-fw"></i> Final Code and Report</a></li>
<li class="toctree-l3"><a class="reference internal" href="../final-project/handouts/presentation.html"><i class="fas fa-book fa-fw"></i> Final Presentation</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../final-project/tips/index.html"><i class="fas fa-layer-group fa-fw"></i> Final Project - Tips</a><input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-10"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../final-project/tips/discovery.html"><i class="fas fa-book fa-fw"></i> Discovery Tips</a></li>
<li class="toctree-l3"><a class="reference internal" href="../final-project/tips/report.html"><i class="fas fa-book fa-fw"></i> Tips for Final Report</a></li>
<li class="toctree-l3"><a class="reference internal" href="../final-project/tips/presentation.html"><i class="fas fa-book fa-fw"></i> Tips for Final Presentation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../final-project/tips/ML.html"><i class="fas fa-book fa-fw"></i> Leveraging ML</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="index.html"><i class="fas fa-book fa-fw"></i> Visualizations</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-11"><i class="fa-solid fa-chevron-down"></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="barchart.html">Bar Charts</a></li>
<li class="toctree-l2"><a class="reference internal" href="geospatial.html">Geospatial Plots</a></li>
<li class="toctree-l2"><a class="reference internal" href="lineplots.html">Line Plots</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">Curve of Best Fit</a></li>

<li class="toctree-l2"><a class="reference internal" href="case_study_dist.html">Case Study on Distance</a></li>

</ul>
</li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/jeffstride/idp" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/jeffstride/idp/edit/main/book_source/visualizations/line_of_best_fit.md" target="_blank"
   class="btn btn-sm btn-source-edit-button dropdown-item"
   title="Suggest edit"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-pencil-alt"></i>
  </span>
<span class="btn__text-container">Suggest edit</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/jeffstride/idp/issues/new?title=Issue%20on%20page%20%2Fvisualizations/line_of_best_fit.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/visualizations/line_of_best_fit.md" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.md</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Curve of Best Fit</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Curve of Best Fit</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#seaborn-regression">Seaborn Regression</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#scipy-linregress">SciPy Linregress</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#numpy-polyfit">Numpy Polyfit</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#curve-fit">Curve Fit</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#ml-regressions">ML regressions</a></li>
</ul>

            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="curve-of-best-fit">
<h1>Curve of Best Fit<a class="headerlink" href="#curve-of-best-fit" title="Link to this heading">#</a></h1>
<p>In this section, we will show how you can identify a Curve of Best Fit for a set of data points.
The curve can be anything an equation can express, but there are some limitations with discontinuous curves and asymptotes.
The easiest is finding a line of best fit. Secondarily, you can find the polynomial that fits the data points. Tertiary,
you can provide an equation of a continuous curve involving a combination of functions such as sine or logarithm.
Lastly, you can have a non-continuous curve like Sigmoid or `y = 1 / (x - 3).</p>
<p>We will review four different ways to get the equation of a fitted curve.</p>
<ol class="arabic simple">
<li><p><code class="docutils literal notranslate"><span class="pre">scipy.stats.linregress</span></code>: a statistical method that identifies a line’s coefficients as well some statistical information.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">numpy.polyfit</span></code>: a Numpy method that identifies the coefficients of any n-ordered polynomial.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">scipy.stats.curve_fit</span></code>: a statistical method that identifies the coefficients of <strong><em>any</em> function</strong> as well as some statistical information about the fit.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ML</span> <span class="pre">LinearRegression</span></code>:</p></li>
</ol>
<p>When identifying a Curve of Best Fit, it is good to know <em>how good</em> the curve is at representing
the data points. We want an objective quantification that tells us whether a straight line is better at fitting
the points, or some other curved line such as a parabola. We can compare how well two different lines fit using
the Mean Squared Error.</p>
<p>Often we want to know how much of a correlation there is between the x &amp; y data points. Afterall,
we may have just asked Seaborn to plot a regression line and the line presented is the best line that fits the
data, but is the data linearly related at all? This is a different, but also important question! This is
answered by looking at the <code class="docutils literal notranslate"><span class="pre">Coefficient</span> <span class="pre">of</span> <span class="pre">Determination</span></code>.</p>
<div class="dropdown tip admonition">
<p class="admonition-title"><span class="math notranslate nohighlight">\(R^2\)</span> or Coefficient of Determination</p>
<p>R-squared (<span class="math notranslate nohighlight">\(R^2\)</span>) is a statistical measure that provides an indication of how well the line of best fit (the regression line) fits the data points. It quantifies the proportion of the variance in the dependent variable (y) that can be explained by the independent variable (x) in a linear regression model.</p>
<p>The R-squared value ranges from 0 to 1. A value of 1 indicates that the regression line perfectly predicts the dependent variable, meaning all the data points lie exactly on the line. A value of 0 indicates that the regression line does not explain any of the variance in the dependent variable, and the points are scattered randomly.</p>
<p>In general, a higher R-squared value indicates a better fit of the line to the data. For example, an R-squared value of 0.8 means that 80% of the variability in the dependent variable is accounted for by the independent variable(s) in the model.</p>
</div>
<p>Here is a table that shows some of the most frequent API we used in this section.</p>
<table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>API</p></th>
<th class="head"><p>Notes</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><a class="reference external" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.plot.html">plt.plot</a></p></td>
<td><p>This does a simple line plot on the current axis. It does not offer ‘ax=ax’ argument.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference external" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.scatter.html">plt.scatter</a></p></td>
<td><p>This does a simple scatter plot on the current axis. It does not offer ‘ax=ax’ argument.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference external" href="https://seaborn.pydata.org/generated/seaborn.regplot.html">np.linspace</a></p></td>
<td><p>This creates a numpy array of values linearly spaced between [start, end] with a specific number of points. It is helpful in generating <code class="docutils literal notranslate"><span class="pre">x_data</span></code> during plotting.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.polyfit.html">np.polyfit</a></p></td>
<td><p>This identifies the coefficients of any n-ordered polynomial.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.stats.linregress.html">linregress</a></p></td>
<td><p>a statistical method that identifies a line’s coefficients as well some statistical information.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.optimize.curve_fit.html#scipy.optimize.curve_fit">curve_fit</a></p></td>
<td><p>A statistical method that identifies the coefficients of <strong><em>any</em> function</strong> as well as some statistical information about the fit.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.metrics.mean_squared_error.html">mean_squared_error</a></p></td>
<td><p>Calculates the Mean Squared Error (MSE) from two sets of y_data points.</p></td>
</tr>
</tbody>
</table>
<div class="dropdown seealso admonition">
<p class="admonition-title">code imports</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">random</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>

<span class="kn">from</span> <span class="nn">scipy.optimize</span> <span class="kn">import</span> <span class="n">curve_fit</span>
<span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">linregress</span>
<span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">stats</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">mean_squared_error</span>

<span class="n">sns</span><span class="o">.</span><span class="n">set</span><span class="p">()</span>

<span class="c1"># This if for Jupyter Notebook only</span>
<span class="o">%</span><span class="n">matplotlib</span> <span class="n">inline</span>
</pre></div>
</div>
</div>
<section id="seaborn-regression">
<h2>Seaborn Regression<a class="headerlink" href="#seaborn-regression" title="Link to this heading">#</a></h2>
<p>In many research projects, it is beneficial to find a curved line that best fits the data.
Students will often do a scatter plot of the data points and have Seaborn do a regression plot
which shows a line of best fit with a shaded area around the line representing
a 95% confidence interval. None of that is horrible. It is convenient to have a line of best fit,
if there is one. And, <code class="docutils literal notranslate"><span class="pre">regplot</span></code> will draw one for you by default.</p>
<div class="sd-tab-set docutils">
<input checked="checked" id="sd-tab-item-0" name="sd-tab-set-0" type="radio">
</input><label class="sd-tab-label" for="sd-tab-item-0">
Simple regplot</label><div class="sd-tab-content docutils">
<p><img alt="regplot" src="../_images/bestfit_simple_reg.png" /></p>
</div>
<input id="sd-tab-item-1" name="sd-tab-set-0" type="radio">
</input><label class="sd-tab-label" for="sd-tab-item-1">
Code</label><div class="sd-tab-content docutils">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">true_slope</span> <span class="o">=</span> <span class="mi">3</span><span class="o">/</span><span class="mi">4</span>
<span class="n">true_intercept</span> <span class="o">=</span> <span class="o">-</span><span class="mi">4</span>
<span class="n">x_data</span> <span class="o">=</span> <span class="p">[</span> <span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="p">]</span>
<span class="n">y_data</span> <span class="o">=</span> <span class="p">[</span> <span class="n">x</span><span class="o">*</span><span class="n">true_slope</span> <span class="o">+</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span> <span class="o">+</span> <span class="n">true_intercept</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">x_data</span><span class="p">]</span>

<span class="c1"># Use the grid in the plot and set the line style to black &amp; dashed</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">regplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">x_data</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y_data</span><span class="p">)</span>
</pre></div>
</div>
</div>
<input id="sd-tab-item-2" name="sd-tab-set-0" type="radio">
</input><label class="sd-tab-label" for="sd-tab-item-2">
Comments</label><div class="sd-tab-content docutils">
<p>This is about as simple as it gets. We generated <code class="docutils literal notranslate"><span class="pre">x_data</span></code> with a simple comprehension. We could
have also used <code class="docutils literal notranslate"><span class="pre">np.linspace()</span></code>. We similarly created the <code class="docutils literal notranslate"><span class="pre">y_data</span></code> and added some noise with
<code class="docutils literal notranslate"><span class="pre">random.randint(-5,</span> <span class="pre">5)</span></code>. By default, <code class="docutils literal notranslate"><span class="pre">regplot</span></code> will add a regression line and a confidence
interval. The confidence interval is 95% and students often misunderstand what it means.</p>
<p>It does <strong>NOT</strong> mean that there is a 95% confidence that the points in the scatter plot will
fall within the shaded interval. Clearly, that is not the case!</p>
<p>It means, insteatd, that there is a 95% confidence that the average of the scatter plot data falls within that range.
I know what you’re thinking: the average of the data is clear and concrete–there is no need to estimate it.
That is true. The average is easy to
calculate with a finite set of points that <strong>are</strong> the <em>true population</em> data.
<code class="docutils literal notranslate"><span class="pre">regplot</span></code> estimates what the <em>true population</em> might look like assuming that your data is just a sample. It then calculates
the confidence interval based on the assumption that the errors (residuals) in the regression model
follow a normal distribution. It is 95% sure that the <em>true average</em> falls in that range.</p>
<p>Note that in your research, you may want to extend the curve of best fit out further. You can see
how to do this in the next plot below.</p>
<p>Here are some helpful links:<br />
<a href="https://seaborn.pydata.org/tutorial/regression.html" target="_blank">Seaborn Tutorial</a><br />
<a href="http://seaborn.pydata.org/generated/seaborn.regplot.html" target="_blank">Seaborn regplot API</a></p>
<div class="important admonition">
<p class="admonition-title">Lastly</p>
<p>It is common to hide the shaded confidence interval by setting the named parameter, <code class="docutils literal notranslate"><span class="pre">ci</span></code> to <code class="docutils literal notranslate"><span class="pre">None</span></code>, as follows:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">regplot</span><span class="p">(</span><span class="n">x_data</span><span class="p">,</span> <span class="n">y_data</span><span class="p">,</span> <span class="n">ci</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
</section>
<section id="scipy-linregress">
<h2>SciPy Linregress<a class="headerlink" href="#scipy-linregress" title="Link to this heading">#</a></h2>
<div class="sd-tab-set docutils">
<input checked="checked" id="sd-tab-item-3" name="sd-tab-set-1" type="radio">
</input><label class="sd-tab-label" for="sd-tab-item-3">
Annotated Regression</label><div class="sd-tab-content docutils">
<p>This plot shows a scatter plot of data drawn with <code class="docutils literal notranslate"><span class="pre">plt.scatter</span></code>. It then finds the line of best fit using
<code class="docutils literal notranslate"><span class="pre">linregress</span></code>. It plots it out, extending an extra 20 values on the x-axis, and it provides data on the
graph itself. It shows what the slope and y-intercept are (m &amp; b), gives the <span class="math notranslate nohighlight">\(R^2\)</span> value, and lastly
it presents the Mean Squared Error.<br />
<img alt="regplot" src="../_images/bestfit_linregress.png" /></p>
</div>
<input id="sd-tab-item-4" name="sd-tab-set-1" type="radio">
</input><label class="sd-tab-label" for="sd-tab-item-4">
Code</label><div class="sd-tab-content docutils">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># use the same x_data &amp; y_data in example above.</span>
<span class="c1"># To find details about the line, we need to use linregress.</span>
<span class="n">slope</span><span class="p">,</span> <span class="n">intercept</span><span class="p">,</span> <span class="n">r_value</span><span class="p">,</span> <span class="n">p_value</span><span class="p">,</span> <span class="n">std_err</span> <span class="o">=</span> <span class="n">linregress</span><span class="p">(</span><span class="n">x_data</span><span class="p">,</span> <span class="n">y_data</span><span class="p">)</span>

<span class="c1"># generate 100 x_fit points and go out 20 past x_data limits to show &quot;prediction&quot;</span>
<span class="n">x_fit</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">x_data</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">x_data</span><span class="p">)</span><span class="o">+</span><span class="mi">20</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">y_fit</span> <span class="o">=</span> <span class="n">intercept</span> <span class="o">+</span> <span class="n">slope</span> <span class="o">*</span> <span class="n">x_fit</span>

<span class="c1"># create a &#39;vector&#39; (list of values) for the line of best fit.</span>
<span class="c1"># We use the scalar values (1 value) from linregress and the original x_data points.</span>
<span class="c1"># We need the same number of y values as are in y_data.</span>
<span class="n">y_predicted</span> <span class="o">=</span> <span class="n">intercept</span> <span class="o">+</span> <span class="n">slope</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">x_data</span><span class="p">)</span>

<span class="c1"># Calculate the MSE </span>
<span class="n">mse</span> <span class="o">=</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_data</span><span class="p">,</span> <span class="n">y_predicted</span><span class="p">)</span>

<span class="c1"># plot our data points with line of best fit with info on the graph</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x_data</span><span class="p">,</span> <span class="n">y_data</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Actual&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_fit</span><span class="p">,</span> <span class="n">y_fit</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Fitted&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Best Linear Fit&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;X&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Y&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">42</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;m = </span><span class="si">{</span><span class="n">slope</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="se">\n</span><span class="s1">b = </span><span class="si">{</span><span class="n">intercept</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="se">\n</span><span class="s1">R2 = </span><span class="si">{</span><span class="n">r_value</span><span class="o">**</span><span class="mi">2</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="se">\n</span><span class="s1">MSE = </span><span class="si">{</span><span class="n">mse</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> 
         <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;top&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
</pre></div>
</div>
</div>
<input id="sd-tab-item-5" name="sd-tab-set-1" type="radio">
</input><label class="sd-tab-label" for="sd-tab-item-5">
Comments</label><div class="sd-tab-content docutils">
<p>The nice thing about using <code class="docutils literal notranslate"><span class="pre">linregress</span></code> is that it will provide multiple pieces of information
for us in one simple call. It gives use the slope and intercept values, along with the <code class="docutils literal notranslate"><span class="pre">r_value</span></code> that
we can square to get the Coefficient of Determination.</p>
<p>Interestingly, <code class="docutils literal notranslate"><span class="pre">linregress</span></code> returns an object, not a list of values. However, because the linrgress object
returns implements the special method <code class="docutils literal notranslate"><span class="pre">__iter__</span></code>, the object can be unpacked into a set of values. This gives
some flexibility in how the caller wants to receive the values. The caller can keep the object and dereference
the object, or the specific values can be immediately unpacked upon receipt. Cool!</p>
<p>Example call:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>    <span class="n">line_info</span> <span class="o">=</span> <span class="n">linregress</span><span class="p">(</span><span class="n">x_data</span><span class="p">,</span> <span class="n">y_data</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;R2=</span><span class="si">{</span><span class="n">line_info</span><span class="o">.</span><span class="n">r_value</span><span class="o">**</span><span class="mi">2</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>  
</pre></div>
</div>
</div>
</div>
</section>
<section id="numpy-polyfit">
<h2>Numpy Polyfit<a class="headerlink" href="#numpy-polyfit" title="Link to this heading">#</a></h2>
<p>Here we use <code class="docutils literal notranslate"><span class="pre">np.polyfit</span></code> to find the best fit for a line and a parabola. Put another way,
the coefficients of a polynomial of degree 1 and 2.</p>
<div class="sd-tab-set docutils">
<input checked="checked" id="sd-tab-item-6" name="sd-tab-set-2" type="radio">
</input><label class="sd-tab-label" for="sd-tab-item-6">
Best Fit Plot</label><div class="sd-tab-content docutils">
<p>The graph shows many things: scatter plot of data, line of best fit, parabola of best fit,
a legend, coefficients of the parabola of best fit, and MSE of both the parabola and line. Whew!<br />
It shows that the parabola is a much better fit for the points.<br />
<img alt="regplot" src="../_images/bestfit_polyfit.png" /></p>
</div>
<input id="sd-tab-item-7" name="sd-tab-set-2" type="radio">
</input><label class="sd-tab-label" for="sd-tab-item-7">
Code</label><div class="sd-tab-content docutils">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">add_inset_text</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="n">position</span><span class="p">,</span> <span class="n">actual</span><span class="p">,</span> <span class="n">coeffs</span><span class="p">):</span>
    <span class="c1"># print values in an inset positioned in figure percentages [x, y, width, height]</span>
    <span class="n">ax_inset</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_axes</span><span class="p">(</span><span class="n">position</span><span class="p">)</span>
    <span class="n">ax_inset</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
    <span class="n">ax_inset</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
    <span class="n">ax_inset</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">([])</span>
    <span class="n">ax_inset</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">([])</span>
    <span class="n">ax_inset</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">text</span> <span class="o">=</span> <span class="s1">&#39;Coeff Actual vs Pred&#39;</span>
    <span class="n">ax_inset</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.90</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;top&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
    <span class="n">text</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
    <span class="k">for</span> <span class="n">a</span><span class="p">,</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">actual</span><span class="p">,</span> <span class="n">coeffs</span><span class="p">):</span>
        <span class="n">text</span> <span class="o">+=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">a</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1"> vs </span><span class="si">{</span><span class="n">c</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="se">\n</span><span class="s1">&#39;</span>
    <span class="n">ax_inset</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.18</span><span class="p">,</span> <span class="mf">.70</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;top&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">ax_inset</span>
    
    
<span class="k">def</span> <span class="nf">best_parabola_fit</span><span class="p">():</span>
    <span class="k">def</span> <span class="nf">parabola</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">a</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">b</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="n">c</span>
        <span class="k">return</span> <span class="n">y</span>

    <span class="k">def</span> <span class="nf">generate_points</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">noise</span><span class="p">):</span>
        <span class="n">x_data</span> <span class="o">=</span> <span class="p">[</span> <span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="p">]</span>
        <span class="n">y_data</span> <span class="o">=</span> <span class="p">[</span> <span class="n">parabola</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span> <span class="o">+</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="o">-</span><span class="n">noise</span><span class="p">,</span> <span class="n">noise</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">x_data</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">x_data</span><span class="p">,</span> <span class="n">y_data</span>
    
    <span class="c1"># establish our True parabola coefficients</span>
    <span class="n">actual</span> <span class="o">=</span> <span class="p">(</span><span class="mf">0.45</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">,</span> <span class="o">-</span><span class="mi">7</span><span class="p">)</span>
    <span class="n">noise</span> <span class="o">=</span> <span class="mi">150</span>
    <span class="n">x_data</span><span class="p">,</span> <span class="n">y_data</span> <span class="o">=</span> <span class="n">generate_points</span><span class="p">(</span><span class="o">*</span><span class="n">actual</span><span class="p">,</span> <span class="n">noise</span><span class="p">)</span>
    
    <span class="c1"># plot it all</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>

    <span class="c1"># Use the grid in the plot and set the line style to black &amp; dashed</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
    
    <span class="c1"># Eliminate the confidence interval shading of the parapola and color the line red</span>
    <span class="n">sns</span><span class="o">.</span><span class="n">regplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">x_data</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y_data</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">ci</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">line_kws</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;color&#39;</span><span class="p">:</span><span class="s1">&#39;red&#39;</span><span class="p">})</span>
    
    <span class="c1"># Determine if a linear line is a better fit using MSE</span>
    <span class="c1"># find the coefficients of the parbola that best fits the points generated</span>
    <span class="c1"># The coefficients are ordered from high order to lower order</span>
    <span class="n">coeffs_2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">polyfit</span><span class="p">(</span><span class="n">x_data</span><span class="p">,</span> <span class="n">y_data</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
    <span class="n">y_predicted_2</span> <span class="o">=</span> <span class="p">[</span> <span class="n">coeffs_2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">coeffs_2</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="n">coeffs_2</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">x_data</span><span class="p">]</span>
    <span class="n">mse_degree_2</span> <span class="o">=</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_data</span><span class="p">,</span> <span class="n">y_predicted_2</span><span class="p">)</span>
    
    <span class="c1">#  get coefficients for the line</span>
    <span class="n">coeffs_1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">polyfit</span><span class="p">(</span><span class="n">x_data</span><span class="p">,</span> <span class="n">y_data</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="c1"># Use vector math instead of a comprehension this time (because we can)</span>
    <span class="n">y_predicted_1</span> <span class="o">=</span> <span class="n">coeffs_1</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">coeffs_1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">x_data</span><span class="p">)</span>
    <span class="n">mse_degree_1</span> <span class="o">=</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_data</span><span class="p">,</span> <span class="n">y_predicted_1</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;MSE Degree2:&#39;</span><span class="p">,</span> <span class="n">mse_degree_2</span><span class="p">,</span> <span class="s1">&#39; MSE Degree1:&#39;</span><span class="p">,</span> <span class="n">mse_degree_1</span><span class="p">)</span>
    
    <span class="c1"># add MSE to our inset text box</span>
    <span class="n">ax_inset</span> <span class="o">=</span> <span class="n">add_inset_text</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="p">[</span><span class="mf">0.15</span><span class="p">,</span> <span class="mf">0.50</span><span class="p">,</span> <span class="mf">0.35</span><span class="p">,</span> <span class="mf">0.28</span><span class="p">],</span> <span class="n">actual</span><span class="p">,</span> <span class="n">coeffs_2</span><span class="p">)</span>
    <span class="n">ax_inset</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.90</span><span class="p">,</span> <span class="s1">&#39;MSE:&#39;</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;top&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
    <span class="n">text</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;Line:</span><span class="si">{</span><span class="n">mse_degree_1</span><span class="si">:</span><span class="s1">.0f</span><span class="si">}</span><span class="se">\n</span><span class="s1">Para:</span><span class="si">{</span><span class="n">mse_degree_2</span><span class="si">:</span><span class="s1">.0f</span><span class="si">}</span><span class="s1">&#39;</span>
    <span class="n">ax_inset</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.65</span><span class="p">,</span> <span class="mf">.70</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;top&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
    
    <span class="c1"># since plt.plot() does not offer ax=ax argument, and without it we plot on the inset,</span>
    <span class="c1"># use ax.plot() to get the line to show up on the right axis.</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_data</span><span class="p">,</span> <span class="n">y_predicted_1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;green&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Best Parabola &amp; Line Fit&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
    
    <span class="c1"># Need to set the legend on the axis to get things to show up correctly,</span>
    <span class="c1"># even when setting label=&#39;&#39;values&#39; during plots, we need to set the label strings here.</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s1">&#39;Parabola Fit&#39;</span><span class="p">,</span> <span class="s1">&#39;Line Fit&#39;</span><span class="p">,</span> <span class="s1">&#39;Actual&#39;</span><span class="p">],</span> <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;lower right&#39;</span><span class="p">)</span>

</pre></div>
</div>
</div>
<input id="sd-tab-item-8" name="sd-tab-set-2" type="radio">
</input><label class="sd-tab-label" for="sd-tab-item-8">
Comments</label><div class="sd-tab-content docutils">
<p>In this code we use <code class="docutils literal notranslate"><span class="pre">sns.regplot</span></code> with <code class="docutils literal notranslate"><span class="pre">order=2</span></code> to draw a portion of a parabola (in red) that best
fits our set of points (in blue). The order, value 2, tell Seaborn the highest exponent in the polynomial.
A value of 2 means a parabola. The default value of 1 is a line. We also set <code class="docutils literal notranslate"><span class="pre">ci=None</span></code> to avoid drawing
any shaded area around the line.</p>
<p>Seaborn will draw the line but it doesn’t give us the equation of the line. It also fails to give us
any value that tells us how well the line fits our set of points. To identify the coefficients for
both the line and polynomial, we use <code class="docutils literal notranslate"><span class="pre">np.polyfit</span></code> and pass in the original data points with the order
of polynomial to use.</p>
<p>Mean Squared Error (MSE) is defined to be the sum of all squared residuals (different between the line and
the data point). The implementation is quite simple:<br />
<code class="docutils literal notranslate">&#160;&#160; <span class="pre">mse</span> <span class="pre">=</span> <span class="pre">sum([</span> <span class="pre">(y1</span> <span class="pre">-</span> <span class="pre">y2)**2</span> <span class="pre">for</span> <span class="pre">y1,</span> <span class="pre">y2</span> <span class="pre">in</span> <span class="pre">zip(y_points,</span> <span class="pre">y_line)])</span></code></p>
<p>In this sample code, we use “vector” math to calculate the y values for the line (or predicted curve).<br />
<code class="docutils literal notranslate">&#160;&#160; <span class="pre">y_predicted_1</span> <span class="pre">=</span> <span class="pre">coeffs_1[1]</span> <span class="pre">+</span> <span class="pre">coeffs_1[0]</span> <span class="pre">*</span> <span class="pre">np.array(x_data)</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">Numpy</span></code> arrays are “vectors” and allow us to multiply them by a “scalar” (a constant, non-array). The above code will result
in a “vector” (numpy array of values) without having to do a for-loop or comprehension. You cannot do
this with a regular list; it requires a numpy array. Convention often has us representing a vector of
values with a capital letter which can sometimes be confused with a constant. Here would be another
conventional way to do vector math.<br />
<code class="docutils literal notranslate">&#160;&#160; <span class="pre">X</span> <span class="pre">=</span> <span class="pre">np.array(list_of_x_values)</span></code>
<code class="docutils literal notranslate">&#160;&#160; <span class="pre">Y</span> <span class="pre">=</span> <span class="pre">3</span> <span class="pre">*</span> <span class="pre">X</span> <span class="pre">+</span> <span class="pre">4</span></code></p>
<p>Lastly, we make use of an inset to annotate some text to the graph so the reader can see how much
better the curve is over the line. MSE values are relative and the values depend on the scale of the numbers.
MSE values are most valuable when compared against another MSE value. In this case we can see how the
parabola’s MSE value is close to half the value of the line’s MSE.</p>
</div>
</div>
</section>
<section id="curve-fit">
<h2>Curve Fit<a class="headerlink" href="#curve-fit" title="Link to this heading">#</a></h2>
<p>Here we see how we can find a curve of best fit to a custom, continuous curve: a logarithmically degrading, sinusoidal wave.
This is a continuous curve with no x-value that causes a division by zero. This allows us to use the <code class="docutils literal notranslate"><span class="pre">curve_fit</span></code> API. It will
highly unlikely that you’ll ever want to fit a set of points to a curve like this. In the event that you ever encounter
wave data, you’ll more likely want to leverage <a href="https://youtu.be/spUNpyF58BY" target="_blank">Fourier Transforms.</a> The
reason we use a sinusoidal wave is simply to illustrate how <code class="docutils literal notranslate"><span class="pre">curve_fit</span></code> can be used on any curve.</p>
<p>To fit a line to a curve:</p>
<ol class="arabic simple">
<li><p>Identify an equation that you want to fit. You’ll create a method that has the generalized
equation with coefficients that are unknown. For example, a line is: <code class="docutils literal notranslate"><span class="pre">y</span> <span class="pre">=</span> <span class="pre">mx</span> <span class="pre">+</span> <span class="pre">b</span></code> where curve_fit will identify the values
for <code class="docutils literal notranslate"><span class="pre">m</span></code> and <code class="docutils literal notranslate"><span class="pre">b</span></code>. You may have a polynomial curve such as: <code class="docutils literal notranslate"><span class="pre">y</span> <span class="pre">=</span> <span class="pre">a*x**4</span> <span class="pre">+</span> <span class="pre">b*x**3</span> <span class="pre">+</span> <span class="pre">c*x**2</span> <span class="pre">+</span> <span class="pre">d*x</span> <span class="pre">+</span> <span class="pre">e</span></code> and curve_fit will
find the values for <code class="docutils literal notranslate"><span class="pre">a</span></code> through <code class="docutils literal notranslate"><span class="pre">e</span></code>. If you know want to fix one of the values, you can use a constant to the known
value. Write a method that takes <code class="docutils literal notranslate"><span class="pre">x</span></code> along with the coefficients are arguments. For example:</p></li>
</ol>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">my_function</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">a</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">b</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="n">c</span>
</pre></div>
</div>
<ol class="arabic simple" start="2">
<li><p>Select a set of values for the coefficients that represents a valid guess. Assign these coefficients to a
list, often named, <code class="docutils literal notranslate"><span class="pre">p0</span></code>. You’ll provide <code class="docutils literal notranslate"><span class="pre">p0</span></code> as an argument to <code class="docutils literal notranslate"><span class="pre">curve_fit</span></code> to help it get started as well as to
understand how many coefficients to solve for.</p></li>
<li><p>You’ll call <code class="docutils literal notranslate"><span class="pre">curve_fit</span></code> with the following arguments: methoid pointer, set of points you want to fit, along
with the initial guess. For example:</p></li>
</ol>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># curve_fit returns a tuple. The first item is a list of coefficients. The second</span>
<span class="c1"># is statistical information about the coefficients. In this example we ignore</span>
<span class="c1"># the covariance values, and so we unpack them into the identifier &#39;_&#39; which is a conventional</span>
<span class="c1"># name for a variable that goes ignored and unused.</span>
<span class="n">coeffs</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">curve_fit</span><span class="p">(</span><span class="n">logarithmic_sinusoidal_wave</span><span class="p">,</span> <span class="n">x_data</span><span class="p">,</span> <span class="n">y_data</span><span class="p">,</span> <span class="n">p0</span><span class="o">=</span><span class="n">p0</span><span class="p">)</span>
</pre></div>
</div>
<div class="sd-tab-set docutils">
<input checked="checked" id="sd-tab-item-9" name="sd-tab-set-3" type="radio">
</input><label class="sd-tab-label" for="sd-tab-item-9">
Sinusoidal</label><div class="sd-tab-content docutils">
<p>In our custom curve, we have coefficients for each of the following: amplitude, frequency, rate of logarithmic
degredation, phase and offset.</p>
<p>The top plot has “zero arguments” provided in the method <code class="docutils literal notranslate"><span class="pre">logarithmic_sinusoidal_wave</span></code> which means that
it uses all the default values (10, 1, 0.2, 0, 0). This is why the title of the top plot is: “Arguments: ()”.</p>
<p>The bottom plot is the same equation but with specific coefficients provided (15, 0.5, 0.1, 0, 10). It
shows how the coefficients impact the curve. Pay attention to the values on the y-axis.<br />
<img alt="regplot" src="../_images/bestfit_curve_two.png" /></p>
<div class="dropdown seealso admonition">
<p class="admonition-title">See Code</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">logarithmic_sinusoidal_wave</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">a</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">frequency</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">r</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">phase</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">offset</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
    <span class="c1"># Logarithmic convergence of amplitude</span>
    <span class="n">amplitude</span> <span class="o">=</span> <span class="n">a</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">r</span> <span class="o">*</span> <span class="n">x</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">offset</span> <span class="o">+</span> <span class="n">amplitude</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">frequency</span> <span class="o">*</span> <span class="n">x</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">plot_with_args</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">x_max</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
    <span class="c1"># Generate x values</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">x_max</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>
    <span class="c1"># Compute y values (plural) </span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">logarithmic_sinusoidal_wave</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">)</span>

    <span class="c1"># Plot on the axis &amp; show labels</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;X&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Amplitude&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Arguments: </span><span class="si">{</span><span class="n">args</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
        
<span class="k">def</span> <span class="nf">show_sinusoidal_curve</span><span class="p">():</span>    
    <span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">9</span><span class="p">))</span>
    <span class="c1"># add some more spacing horizontally between the two subplots</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">hspace</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
    <span class="n">plot_with_args</span><span class="p">(</span><span class="n">ax1</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>
    
    <span class="n">wave_args</span> <span class="o">=</span> <span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
    <span class="n">plot_with_args</span><span class="p">(</span><span class="n">ax2</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="o">*</span><span class="n">wave_args</span><span class="p">)</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;Logarithmic Sinusoidal Waves&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<input id="sd-tab-item-10" name="sd-tab-set-3" type="radio">
</input><label class="sd-tab-label" for="sd-tab-item-10">
Best Fit</label><div class="sd-tab-content docutils">
<p>This plot shows the generated data points (that have noise) as small red dots. These data points
were derived by adding a noise (<span class="math notranslate nohighlight">\(\pm 1\)</span>) to the sinusoidal equation using the argments (15, 0.5, 0.1, 0, 10).</p>
<p>The blue line is the best fit curve that fits the <code class="docutils literal notranslate"><span class="pre">logarithmic_sinusoidal_wave</span></code> (provided
in the code of the Sinusoidal tab.)</p>
<p>The inset shows how the actual arguments used when generating the points with noise, and it compares
them against the coefficients for the curve of best fit. Here you can see that it slightly underestimated
the amplitidue. It was 0.15 off of the frequency, only 0.01 way from the rate of degradation, and only
0.02 away from the offset. The phase was 6.56 off of the actual phase used.<br />
<img alt="regplot" src="../_images/bestfit_curve_fit.png" /></p>
</div>
<input id="sd-tab-item-11" name="sd-tab-set-3" type="radio">
</input><label class="sd-tab-label" for="sd-tab-item-11">
Code</label><div class="sd-tab-content docutils">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span> <span class="k">def</span> <span class="nf">find_curve_best_fit</span><span class="p">():</span>
    <span class="k">def</span> <span class="nf">generate_points</span><span class="p">(</span><span class="n">noise</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        *args : allow us to call the function with any number of arguments so long as they are in order.</span>
<span class="sd">                we would just default the rest of the argument values.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">x_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">55</span><span class="p">)</span>
        <span class="n">y_data</span> <span class="o">=</span> <span class="p">[</span> <span class="n">logarithmic_sinusoidal_wave</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">)</span> <span class="o">+</span> <span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="o">-</span><span class="n">noise</span><span class="p">,</span> <span class="n">noise</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">x_data</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">x_data</span><span class="p">,</span> <span class="n">y_data</span>
    
    <span class="c1"># establish our True curve parameters and generate points</span>
    <span class="n">wave_args</span> <span class="o">=</span> <span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
    <span class="n">x_data</span><span class="p">,</span> <span class="n">y_data</span> <span class="o">=</span> <span class="n">generate_points</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">*</span><span class="n">wave_args</span><span class="p">)</span>
    
    <span class="c1"># get our initial guess as to what the coefficients will be.</span>
    <span class="c1"># the count of arguments here tells curve_fit how many arguments to optimize.</span>
    <span class="n">p0</span> <span class="o">=</span> <span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">.5</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
    <span class="c1"># find our curve of best fit from the line, and round off the coefficient values</span>
    <span class="n">coeffs</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">curve_fit</span><span class="p">(</span><span class="n">logarithmic_sinusoidal_wave</span><span class="p">,</span> <span class="n">x_data</span><span class="p">,</span> <span class="n">y_data</span><span class="p">,</span> <span class="n">p0</span><span class="o">=</span><span class="n">p0</span><span class="p">)</span>
    <span class="n">coeffs</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">([</span> <span class="nb">round</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">coeffs</span>  <span class="p">])</span>

    <span class="c1"># Plot all of it</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x_data</span><span class="p">,</span> <span class="n">y_data</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
    <span class="n">plot_with_args</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="o">*</span><span class="n">coeffs</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s1">&#39;Best Fit&#39;</span><span class="p">,</span> <span class="s1">&#39;Actual&#39;</span><span class="p">])</span>
    <span class="n">pos</span> <span class="o">=</span> <span class="p">[</span> <span class="mf">.4</span><span class="p">,</span> <span class="mf">.14</span><span class="p">,</span> <span class="mf">.3</span><span class="p">,</span> <span class="mf">.28</span> <span class="p">]</span>
    <span class="n">add_inset_text</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="n">wave_args</span><span class="p">,</span> <span class="n">coeffs</span><span class="p">)</span>
</pre></div>
</div>
</div>
<input id="sd-tab-item-12" name="sd-tab-set-3" type="radio">
</input><label class="sd-tab-label" for="sd-tab-item-12">
Comments</label><div class="sd-tab-content docutils">
<p>The code for the sinusoidal curve equation is provided in the ‘See Code’ dropdown in the
‘Sinusoidal’ tab. In this method we chose to have all the coefficients be named arguments with
default values. This allows us to to easily modify our code to hold some values constant and
allow <code class="docutils literal notranslate"><span class="pre">curve_fit</span></code> to solve for the others. If we had chosen to make <code class="docutils literal notranslate"><span class="pre">p0</span></code> have only two values
in it, then curve_fit would have solved for amplitude &amp; frequency while holding <code class="docutils literal notranslate"><span class="pre">r</span></code>, <code class="docutils literal notranslate"><span class="pre">phase</span></code>
and <code class="docutils literal notranslate"><span class="pre">offset</span></code> constant.</p>
<p>In this plot, we first generated our set of points to which we will fit the sinusoidal curve.
These points are intended to be ‘actual’ data points in our hypothetical experiment that will have some noise.
We generate the points by calling our sinusoidal method will all the coefficients and then add some
random values intended to be “noise” or imperfections in the data.</p>
<p>We chose to pass around the many coefficient to <code class="docutils literal notranslate"><span class="pre">generate_points</span></code> and <code class="docutils literal notranslate"><span class="pre">logarithmic_sinusoidal_wave</span></code> by
using a tuple of values. <code class="docutils literal notranslate"><span class="pre">wave_args</span></code> is a tuple with all the “true” coefficients used in the
hypothetical experiement. The use of tuple shortens the code and makes it easier to read, so
long as you understand what is going on. We unpack the values when we call <code class="docutils literal notranslate"><span class="pre">generate_points</span></code> which
collects and repacks them into the tuple named ‘args’. In turn, it can easily call the sinusoidal method
with the tuple. Altogether, this allows us to generate points and solve for coefficients using as many or
as few arguments as we want, using default values for the rest.</p>
<p>Confusing? See <a class="reference internal" href="../Topics/built-in/arguments.html"><span class="doc std std-doc">Arguments</span></a> for more information.</p>
<p>When generating our data points, we make use of <code class="docutils literal notranslate"><span class="pre">linspace</span></code> which is a nifty method that allows us
to quickly set a minimum, maximum, and an arbitrary number of points. It generates values
evenly spaced in that range.</p>
<p><code class="docutils literal notranslate"><span class="pre">curve_fit</span></code> does a lot of work for us, making use of calculus and statistics to find the coefficients
to the equation we established. Each coefficient represents one dimension, and our equation
represents values in an n-dimensional space. It then uses a method similar to “Gradient Descent”
to find values that minimize the Mean Squared Error for our coefficients and the set of actual points.</p>
<p>Confusing? See the video, <a href="https://youtu.be/IHZwWFHWa-w?t=567" target="_blank">Gradient descent, how nerual
networks learn</a>, by 3Blue1Brown, to get a great visual on Gradient Descent. This video is tailored
to neural networks, but the idea is the same. Gradient Descent is a mathematical method for optimizing
in n-dimensional space.</p>
<p>Note that in <code class="docutils literal notranslate"><span class="pre">ax.scatter</span></code> we provided the x &amp; y data as lists and set some named arguments.
It can be frustrating that plotting methods often have named arguments with different names.
When we call <code class="docutils literal notranslate"><span class="pre">scatter</span></code> on the axis object, we set <code class="docutils literal notranslate"><span class="pre">s</span></code> to change the size of the markers (or dots).</p>
<p>To add more value to the graph, we create an inset with text on the graph.</p>
</div>
</div>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="ml-regressions">
<h1>ML regressions<a class="headerlink" href="#ml-regressions" title="Link to this heading">#</a></h1>
<p>The study on distance using Machine Learning models is done on another page.</p>
<div class="seealso admonition">
<p class="admonition-title">See ML Study</p>
<p><a href='../Topics/machine_learning/feature-importance#predicting-distance'>Predicting Distance</a></p>
</div>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./visualizations"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="lineplots.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Line Plots</p>
      </div>
    </a>
    <a class="right-next"
       href="case_study_dist.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Case Study on Distance</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Curve of Best Fit</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#seaborn-regression">Seaborn Regression</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#scipy-linregress">SciPy Linregress</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#numpy-polyfit">Numpy Polyfit</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#curve-fit">Curve Fit</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#ml-regressions">ML regressions</a></li>
</ul>

  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Jeff Stride
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
<div class="extra_footer">
  <a href="https://idp.mrstride.com/acknowledgements.html">Acknowledgements</a>
</div>
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>