# Corrupt Replit Project
You may find that your Replit project isn't building, or that `flake8` isn't running. I've got two f-words to describe how that feels, but I'm going to say only one of them: frustrating!!  

You can:  
* <a href="replit-tips.html#restart-project">Restart the server</a> with a `kill 1` command.  
* If that doesn't work, you can <a href="#start-over">Start over</a> by deleting the project and starting over.  
* If the Shell isn't allowing you to correctly type in commands, type them out in `notepad` or some other document, copy the text, and then paste them into the shell window.  

Sometimes a project gets corrupt when you install packages incorrectly. So, be
careful when installing packages such as `flake8`. Use the command `poetry add 'flake8 5.0.4'` to install flake8.  

Replit is an amazing platform that has been continuously updating. On the flip side, some of these updates have caused regressions and pain.
For example, Replit has migrated to using `Nix` in combination with `Poetry` to manage dependencies and virtual environments.

```{admonition} What does ChatGPT Say about Nix?
:class: seealso dropdown
Nix is a powerful package manager and build tool that allows for reproducible and isolated environments. It provides a purely functional approach to package management, ensuring that dependencies are managed in a way that doesn't interfere with the host system. Nix environments are isolated sandboxes that contain the exact dependencies needed for a particular project or application.  

On the other hand, poetry.lock is a file generated by Poetry, a Python package and dependency manager. It's used to lock the versions of dependencies installed for a project. This ensures that when you or someone else sets up the project on another machine, the exact same versions of the dependencies are installed, avoiding compatibility issues.  

Combining Nix with poetry.lock allows for even better isolation and reproducibility. Instead of relying on system-wide dependencies or virtual environments, you can create a Nix environment that includes all the necessary dependencies from the poetry.lock file. This way, you have a controlled environment with specific versions of dependencies, making it easier to manage projects across different machines and ensuring consistent behavior.  
```
## Start Over
Sometimes your project's configuration can get corrupt and it becomes too difficult to fix. It's time to start over! But, you don't need to recode everything. Instead:  
1) Download all your coded files.  
2) In the project's name dropdown, click the down arrow, click on the vertical dots, then select `Delete`.   
![Delete Project](../../_static/replit_delete.png)  
3) Restart your project  
3) Drag your saved files into Replit  

## Poetry
I've discovered a few commands you can run in the `shell` tab to help understand and deal with issues.  

`poetry env info`: This command gives a brief status of the environment. If there is anything not set up correctly, it will tell you
by outputting `Valid:  False` as shown in this example output:  
```bash
Virtualenv
Python:         3.8.15
Implementation: CPython
Path:           /home/runner/HW3-Pokemon/venv
Valid:          False

System
Platform: linux
OS:       posix
Python:   /nix/store/5g6y3nzq80fkq54ahan2slc57j6327nj-python3-3.8.15
```
Typically, the problem has to do with the version of `python` and packages installed; there are conflicting
dependencies. When Replit upgraded to `Nix`, it attempted
to make all the updates automatically. When IDP started, we ran python version 3.8. Today, python is up to version 3.11.
In the migration of assignments and checkpoints, folder names and package dependencies got messed up. 

|Command|Description|
|-------|-----------|
|`poetry show`| Provides a list of all the versions of installed packages (or fails if there is corruption).| 
|`poetry show numpy` | Shows the version of `numpy`. | 
|`poetry add 'flake8 5.0.4'` | Installs a specific version of flake8 that is compatible with python version 3.10. In the year 2022-23, IDP used python version 3.8 and flake8 verion 3.9.2.|  
|`poetry update` | Updates all packages and dependencies|  
|`poetry update numpy`| Updates the numpy package|

> git-python error: Recently, when running Unit Tests, I got an error involving "git-python 1.1.1". I was able to resolve this issue by adding `git-python = "1.0"` under the tool.poetry.dependencies section in the file `pyproject.toml`.

Not-so-Helpful links:
* [Using Nix with Replit](https://docs.replit.com/programming-ide/nix-on-replit)
* [Building with Nix on Replit](https://docs.replit.com/tutorials/python/build-with-nix)
